两顶帽子：软件开发中，你的时间会分配给两种截然不同的行为：添加新功能、重构。
	
1.	添加新功能时：你不应该修改既有代码，只管添加新功能。
2.	重构时你就不能再添加功能，只管改进程序结构。

### 为何重构：

#### 1. 重构改进软件设计

> 完成同样一件事儿，设计不良的程序往往需要更多代码，这常常是因为代码在不同的地方使用完全相同的语句做同样的事儿。因此改进设计的一个重要方向就是消除重复代码。代码量减少并不会使系统运行更快，但会使未来可能的程序修改动作容易得多。代码越多，修改越困哪，因为有更多代码需要理解。
> 
你在这儿做了修改，系统却不如预期那样工作，因为你没有修改另一处——那儿的代码做着几乎完全一样的事儿，只是所处环境略有不同。

> 如果消除重复代码，你就可以确定所有事物和行为在代码中表述一次，这正式优秀设计的根本。
> **【自己写代码时，尽量避免——冗余代码的出现】**

#### 2. 重构使软件更容易理解 
> 程序设计，在很大程度上就是告诉你的读者——我要做什么。你的读者无非如下几类：

> * 计算机——准确的告诉编译器你要做什么
> * 程序开发人员
> * 几个月后可能会有另一位程序员尝试读懂你的代码并做一些修改
> 
> 很多时候，我们只会考虑计算机和程序开发人员，但是不曾考虑过几个月后可能会有另一位程序员来读你的代码。如果他花了一周时间来修改某段代码，那才要命——如果他理解了你的代码，这个修改原本只需要一个小时。
> 
> 当你努力让程序运转的时候，不要忘记那个未来可能出现的开发者。**而很多情况，那个未来出现的开发者，往往是你自己** 

#### 3. 重构帮助找到bug

> 如果对代码进行重构，我可以深入理解代码的行为，并恰到好处地把理解反馈回去。
> 
> **我不是一个优秀的程序员，只是一个有着优秀习惯的好程序员。——Kent Beck**
> 
> 此处有问题——什么是优秀的好习惯？

#### 4. 重构提高编程速度

> 高质量的程序中，高质量如何定义——优秀的设计、提升可读性、减少错误。
> 
> 开发中的一个恶性循环：
> > 设计糟糕的代码，或许在某一段事件内能够迅速进展，但恶劣的设计很快就让你的速度慢下来。你会把时间花在调试上面，无法添加新功能。修改时间越来越长，因为你必须花越来越多的时间去裂解系统，寻找重复代码。随着你给最初的程序打上一个又一个的补丁，新特性需要更多代码才能实现。
> > 
> 
> 良好的设计，是维持软件开发速度的根本。重构可以帮助你更快的开发软件，因为它阻止系统腐败变质，还可以帮助提高质量。 


### 何时重构？

不应该为重构而重构，你之所以重构，是因为你想做别的什么事儿，而重构可以帮助你把这些事儿做好。

#### 三次法则

第一次做某件事儿时只管去做；第二次做类似的事会产生反感，但无论如何还是可以去做；第三次再做类似的事儿，就应该重构了。**事不过三，三则重构**

#### 添加功能时重构

重构可以帮助我理解需要修改的代码，并在前进过程中把代码结构理清，一旦完成重构，新特性的添加就会更快速、更流畅。

#### 修补错误时重构

在修改错误的时候进行重构；

#### code review时进行重构


**是什么让程序如此难以相与？**
> 1. 难以阅读的程序，难以修改；
> 2. 逻辑重复的程序，难以修改；
> 3. 添加新行为时需要修改已有代码的程序，难以修改；
> 3. 带复杂条件逻辑的程序，难以修改；

我们希望程序：1. 容易阅读；2. 所有逻辑都只有唯一地点指定；3. 新的修改不会危及现有行为；4. 尽可能简单表达条件逻辑。


